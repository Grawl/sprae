var e,t=(t,r,a=new Set)=>((r={get value(){return e?.deps.push(a.add(e)),t},set value(e){t=e;for(let t of a)t(e)},peek:()=>t}).toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),r=(t,r,a,l)=>(l=(a=l=>{r?.call&&r(),l=e,e=a;try{r=t()}finally{e=l}}).deps=[],a(),e=>{for(;e=l.pop();)e.delete(a)}),a=(e,a=t(),l,s)=>((l={get value(){return s||=r((()=>a.value=e())),a.value}}).toJSON=l.then=l.toString=l.valueOf=()=>l.value,l),l=e=>e(),s=Symbol.dispose||=Symbol("dispose"),n={},o=new WeakMap;function i(e,t){if(o.has(e))return batch((()=>Object.assign(o.get(e),t)));const r=t||{},a=[],l=(e,t=e.parentNode)=>{if(e.attributes)for(let l=0;l<e.attributes.length;){let s=e.attributes[l];if(":"===s.name[0]){e.removeAttribute(s.name);let l=s.name.slice(1).split(":");for(let t of l)a.push((n[t]||n.default)(e,s.value,r,t));if(o.has(e))return;if(e.parentNode!==t)return!1}else l++}for(let t,r=0;t=e.children[r];r++)!1===l(t,e)&&r--};return l(e),o.has(e)||(o.set(e,r),a.length&&(e[s]=()=>{for(;a.length;)a.pop()?.();o.delete(e)})),r}i.use=e=>(t=e.signal,r=e.effect,a=e.computed,l=e.batch,e.untracked),i.compile=e=>new Function("__scope",`with (__scope) { let __; return ${e} };`);var c={},u=(e,t,r)=>{let a=c[t=t.trim()];if(!a)try{a=c[t]=i.compile(t)}catch(a){return p(a,e,t,r)}return(l,s)=>{try{s=a(l)}catch(a){return p(a,e,t,r)}return s?.valueOf()}},p=(e,t,r,a)=>{throw Object.assign(e,{element:t,expr:r}),console.warn(`∴ ${e.message}\n\n${a}=${r?`"${r}"\n\n`:""}`,t),e},f=Symbol("else");n.if=(e,t,l)=>{let s,n=document.createTextNode(""),o=u(e,t,"if"),i=e.nextElementSibling,c=e[f],p=a((()=>o(l)));e.replaceWith(s=n),i?.hasAttribute(":else")?(i.removeAttribute(":else"),i.hasAttribute(":if")?(i[f]=p,i=null):i.remove()):i=null;const d=r((()=>{const t=c?.value?n:p.value?e:i;s!=t&&((s[_each]||s).replaceWith(s=t||n),s!==n&&sprae(s,l))}));return()=>{e[_dispose]?.(),i?.[_dispose]?.(),d()}};var d=(e,t,r,a=null)=>{let l,s,n,o=0,i=r.length,c=t.length,{remove:u,same:p,insert:f,replace:h}=d;for(;o<i&&o<c&&p(t[o],r[o]);)o++;for(;o<i&&o<c&&p(r[i-1],t[c-1]);)a=r[(--c,--i)];if(o==c)for(;o<i;)f(a,r[o++],e);else{for(l=t[o];o<i;)n=r[o++],s=l?l.nextSibling:a,p(l,n)?l=s:o<i&&p(r[o],s)?(h(l,n,e),l=s):f(l,n,e);for(;!p(l,a);)s=l.nextSibling,u(l,e),l=s}return r};d.same=(e,t)=>e==t,d.replace=(e,t,r)=>r.replaceChild(t,e),d.insert=(e,t,r)=>r.insertBefore(t,e),d.remove=(e,t)=>t.removeChild(e);var h=d,y=Symbol(":each");n.each=(e,t,a)=>{let[l,s]=t.split(/\s+in\s+/),[n,o=""]=l.split(/\s*,\s*/);const i=e[y]=document.createTextNode("");e.replaceWith(i);const c=u(e,s,"each");let p=[];return r((()=>{let t=c(a),r=[];"number"==typeof t&&(t=Array.from({length:t},((e,t)=>t)));for(let l in t){let s=e.cloneNode(!0),i=Object.create(a,{[n]:{value:t[l]},[o]:{value:l}});sprae(s,i),r.push(s)}h(i.parentNode,p,r,i),p=r}))},n.ref=(e,t,r)=>{r[t]=e},n.scope=(e,t,r)=>{const a=u(e,t,"scope")(r),l=Object.assign(Object.create(r),m(a));return sprae(e,l),e[_dispose]};var m=e=>{for(let t in e){let r=e[t];Object(r)===r?!r.peek&&m(r):e[t]=signal(r)}return e};n.html=(e,t,r)=>{let a=u(e,t,"html")(r);a||err(new Error("Template not found"),e,t,"html");let l=a.content.cloneNode(!0);return e.replaceChildren(l),sprae(e,r),e[_dispose]},n.text=(e,t,a)=>{let l=u(e,t,"text");return r((()=>{let t=l(a);e.textContent=null==t?"":t}))},n.class=(e,t,a)=>{let l=u(e,t,"class"),s=e.getAttribute("class");return r((()=>{let t=l(a),r=[s];t&&("string"==typeof t?r.push(t):Array.isArray(t)&&r.push(...t)),(r=r.filter(Boolean).join(" "))?e.setAttribute("class",r):e.removeAttribute("class")}))},n.style=(e,t,a)=>{let l=u(e,t,"style"),s=e.getAttribute("style")||"";return s.endsWith(";")||(s+="; "),r((()=>{let t=l(a);if("string"==typeof t)e.setAttribute("style",s+t);else{e.setAttribute("style",s);for(let r in t)e.style.setProperty(r,t[r])}}))},n.value=(e,t,a)=>{let l,s,n=u(e,t,"value"),o="text"===e.type||""===e.type?t=>e.setAttribute("value",e.value=null==t?"":t):"TEXTAREA"===e.tagName||"text"===e.type||""===e.type?t=>(l=e.selectionStart,s=e.selectionEnd,e.setAttribute("value",e.value=null==t?"":t),l&&e.setSelectionRange(l,s)):"checkbox"===e.type?t=>(e.value=t?"on":"",attr(e,"checked",t)):"select-one"===e.type?t=>{for(let t in e.options)t.removeAttribute("selected");e.value=t,e.selectedOptions[0]?.setAttribute("selected","")}:t=>e.value=t;return r((()=>{o(n(a))}))},n.default=(e,t,a,l)=>{let s=l.startsWith("on")&&l.slice(2),n=u(e,t,":"+l);if(n){if(s){let t,l=r((()=>{t&&(t(),t=null),t=g(e,s,n(a))}));return()=>(t?.(),l())}return r((()=>{w(e,l,n(a))}))}};var v,b,g=(e,t,r=(()=>{}))=>{const a={evt:"",target:e,test:()=>!0};a.evt=t.replace(/\.(\w+)?-?([-\w]+)?/g,((e,t,r="")=>(a.test=A[t]?.(a,...r.split("-"))||a.test,"")));const{evt:l,target:s,test:n,defer:o,stop:i,prevent:c,...u}=a;o&&(r=o(r));const p=e=>n(e)&&(i&&e.stopPropagation(),c&&e.preventDefault(),r.call(s,e));return s.addEventListener(l,p,u),()=>s.removeEventListener(l,p,u)},A={prevent(e){e.prevent=!0},stop(e){e.stop=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},throttle(e,t){e.defer=e=>C(e,t?Number(t)||0:108)},debounce(e,t){e.defer=e=>S(e,t?Number(t)||0:108)},outside:e=>t=>{let r=e.target;return!(r.contains(t.target)||!1===t.target.isConnected||r.offsetWidth<1&&r.offsetHeight<1)},self:e=>t=>t.target===e.target,ctrl:(e,...t)=>e=>k.ctrl(e)&&t.every((t=>k[t]?k[t](e):e.key===t)),shift:(e,...t)=>e=>k.shift(e)&&t.every((t=>k[t]?k[t](e):e.key===t)),alt:(e,...t)=>e=>k.alt(e)&&t.every((t=>k[t]?k[t](e):e.key===t)),meta:(e,...t)=>e=>k.meta(e)&&t.every((t=>k[t]?k[t](e):e.key===t)),arrow:()=>k.arrow,enter:()=>k.enter,escape:()=>k.escape,tab:()=>k.tab,space:()=>k.space,backspace:()=>k.backspace,delete:()=>k.delete,digit:()=>k.digit,letter:()=>k.letter,character:()=>k.character},k={ctrl:e=>e.ctrlKey||"Control"===e.key||"Ctrl"===e.key,shift:e=>e.shiftKey||"Shift"===e.key,alt:e=>e.altKey||"Alt"===e.key,meta:e=>e.metaKey||"Meta"===e.key||"Command"===e.key,arrow:e=>e.key.startsWith("Arrow"),enter:e=>"Enter"===e.key,escape:e=>e.key.startsWith("Esc"),tab:e=>"Tab"===e.key,space:e=>" "===e.key||"Space"===e.key||" "===e.key,backspace:e=>"Backspace"===e.key,delete:e=>"Delete"===e.key,digit:e=>/^\d$/.test(e.key),letter:e=>/^[a-zA-Z]$/.test(e.key),character:e=>/^\S$/.test(e.key)},w=(e,t,r)=>{null==r||!1===r?e.removeAttribute(t):e.setAttribute(t,!0===r?"":"number"==typeof r||"string"==typeof r?r:"")},C=(e,t)=>{let r,a,l=s=>{r=!0,setTimeout((()=>{if(r=!1,a)return a=!1,l(s),e(s)}),t)};return t=>r?a=!0:(l(t),e(t))},S=(e,t)=>{let r;return a=>{clearTimeout(r),r=setTimeout((()=>{r=null,e(a)}),t)}},N=e=>(v=0,b=e,e=E(),b[v]?x():e||""),x=(e="Bad syntax",t=b.slice(0,v).split("\n"),r=t.pop())=>{let a=b.slice(v-108,v).split("\n").pop(),l=b.slice(v,v+108).split("\n").shift();throw EvalError(`${e} at ${t.length}:${r.length} \`${v>=108?"…":""}${a}▶${l}\``,"font-weight: bold")},O=(e=1,t=v,r)=>{if("number"==typeof e)v+=e;else for(;r=e(b.charCodeAt(v));)v+=r;return b.slice(t,v)},E=(e=0,t,r,a,l,s)=>{for(;(r=N.space())&&(l=((s=_[r])&&s(a,e))??(!a&&N.id()));)a=l;return t&&(r==t?v++:x()),a},$=e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e,_=(N.id=()=>O($),N.space=e=>{for(;(e=b.charCodeAt(v))<=32;)v++;return e},[]),j=(e,t=32,r,a=e.charCodeAt(0),l=e.length,s=_[a],n=e.toUpperCase()!==e)=>_[a]=(a,o,i=v)=>o<t&&(l<2||b.substr(v,l)==e)&&(!n||!$(b.charCodeAt(v+l)))&&(v+=l,r(a,o))||(v=i,s?.(a,o)),T=(e,t,r=!1)=>j(e,t,((a,l)=>a&&(l=E(t-(r?.5:0)))&&[e,a,l])),W=(e,t,r)=>j(e,t,(a=>r?a&&[e,a]:!a&&(a=E(t-.5))&&[e,a])),B=(e,t)=>{j(e,t,((r,a)=>(a=E(t),(!r||r[0]!==e)&&(r=[e,r]),r.push(a),r)))},K=(e,t)=>j(e[0],t,(t=>!t&&[e,E(0,e.charCodeAt(1))])),D=(e,t)=>j(e[0],t,(t=>t&&[e[0],t,E(0,e.charCodeAt(1))])),J=N,L=e=>Array.isArray(e)?e[0]?M[e[0]](...e.slice(1)):()=>e[1]:L.id(e),M=(L.id=e=>t=>t?.[e],{}),P=(e,t,r=M[e])=>M[e]=(...e)=>t(...e)||r&&r(...e),R=(e,t,r,a,l)=>"()"===e[0]?R(e[1],t,r):"string"==typeof e?r=>t(r,e,r):"."===e[0]?(a=L(e[1]),l=e[2],e=>t(a(e),l,e)):"["===e[0]?(a=L(e[1]),l=L(e[2]),e=>t(a(e),l(e),e)):r?(e=L(e),r=>t([e(r)],0,r)):()=>x("Bad left value"),U=L,z=e=>e?x():[,(e=+O((e=>46===e||e>=48&&e<=57||(69===e||101===e?2:0))))!=e?x():e];_[46]=e=>!e&&z();for(let e=48;e<=57;e++)_[e]=z;var F={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},H=e=>(t,r,a="")=>{for(t&&x("Unexpected string"),O();(r=b.charCodeAt(v))-e;)92===r?(O(),r=O(),a+=F[r]||r):a+=O();return O()||x("Bad string"),[,a]};_[34]=H(34),_[39]=H(39),D("()",17),P("(",((e,t,r)=>(r=t?","===t[0]?(t=t.slice(1).map((e=>e?L(e):err())),e=>t.map((t=>t(e)))):(t=L(t),e=>[t(e)]):()=>[],R(e,((e,t,a)=>e[t](...r(a))),!0)))),D("[]",17),P("[",((e,t)=>t?(e=L(e),t=L(t),r=>e(r)[t(r)]):err())),T(".",17),P(".",((e,t)=>(e=L(e),t=t[0]?t:t[1],r=>e(r)[t]))),K("()",17),P("()",(e=>(!e&&x("Empty ()"),L(e))));var X=(...e)=>(e=e.map(L),t=>e.map((e=>e(t))).pop());B(",",1),P(",",X),B(";",1),P(";",X),T("*",12),P("*",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)*t(r)))),T("/",12),P("/",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)/t(r)))),T("%",12),P("%",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)%t(r)))),T("*=",2,!0),P("*=",((e,t)=>(t=L(t),R(e,((e,r,a)=>e[r]*=t(a)))))),T("/=",2,!0),P("/=",((e,t)=>(t=L(t),R(e,((e,r,a)=>e[r]/=t(a)))))),T("%=",2,!0),P("%=",((e,t)=>(t=L(t),R(e,((e,r,a)=>e[r]%=t(a)))))),W("+",14),P("+",((e,t)=>!t&&(e=L(e),t=>+e(t)))),W("-",14),P("-",((e,t)=>!t&&(e=L(e),t=>-e(t)))),T("+",11),P("+",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)+t(r)))),T("-",11),P("-",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)-t(r)))),T("+=",2,!0),P("+=",((e,t)=>(t=L(t),R(e,((e,r,a)=>e[r]+=t(a)))))),T("-=",2,!0),P("-=",((e,t)=>(t=L(t),R(e,((e,r,a)=>e[r]-=t(a)))))),j("++",15,(e=>e?["++-",e]:["++",E(14)])),P("++",(e=>R(e,((e,t,r)=>++e[t])))),P("++-",(e=>R(e,((e,t,r)=>e[t]++)))),j("--",15,(e=>e?["--+",e]:["--",E(14)])),P("--",(e=>R(e,((e,t,r)=>--e[t])))),P("--+",(e=>R(e,((e,t,r)=>e[t]--)))),W("~",14),P("~",((e,t)=>!t&&(e=L(e),t=>~e(t)))),T("|",5),P("|",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)|t(r)))),T("&",7),P("&",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)&t(r)))),T("^",6),P("^",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)^t(r)))),T(">>",10),P(">>",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)>>t(r)))),T("<<",10),P("<<",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)<<t(r)))),T("==",8),P("==",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)==t(r)))),T("!=",8),P("!=",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)!=t(r)))),T(">",9),P(">",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)>t(r)))),T("<",9),P("<",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)<t(r)))),T(">=",9),P(">=",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)>=t(r)))),T("<=",9),P("<=",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)<=t(r)))),W("!",14),P("!",((e,t)=>!t&&(e=L(e),t=>!e(t)))),T("||",3),P("||",((e,t)=>(e=L(e),t=L(t),r=>e(r)||t(r)))),T("&&",4),P("&&",((e,t)=>(e=L(e),t=L(t),r=>e(r)&&t(r)))),T("=",2,!0),P("=",((e,t)=>(t=L(t),R(e,((e,r,a)=>e[r]=t(a)))))),j("/*",20,((e,t)=>(O((e=>42!==e&&47!==b.charCodeAt(v+1))),O(2),e||E(t)||[]))),j("//",20,((e,t)=>(O((e=>e>=32)),e||E(t)||[""]))),T("**",13,!0),P("**",((e,t)=>t&&(e=L(e),t=L(t),r=>e(r)**t(r)))),j("?",2,((e,t,r)=>e&&(t=E(2,58))&&["?",e,t,E(3)])),P("?",((e,t,r)=>(e=L(e),t=L(t),r=L(r),a=>e(a)?t(a):r(a)))),j("true",20,(e=>e?err():[,!0])),j("false",20,(e=>e?err():[,!1])),K("[]",20),P("[]",((e,t)=>e?","===e[0]?(e=e.slice(1).map(L),t=>e.map((e=>e(t)))):(e=L(e),t=>[e(t)]):()=>[])),K("{}",20),P("{}",((e,t)=>e?","===e[0]?(e=e.slice(1).map(L),t=>Object.fromEntries(e.map((e=>e(t))))):":"===e[0]?(e=L(e),t=>Object.fromEntries([e(t)])):(t=L(e),r=>({[e]:t(r)})):()=>({}))),T(":",2,!0),P(":",((e,t)=>(t=L(t),e=Array.isArray(e)?L(e):(e=>e).bind(0,e),r=>[e(r),t(r)]))),T("=>",2,!0),P("=>",((e,t)=>(e=(e="()"===e[0]?e[1]:e)?e=","===e[0]?e.slice(1):[e]:[],t=L("{}"===t[0]?t[1]:t),(r=null)=>(r=Object.create(r),(...a)=>(e.map(((e,t)=>r[e]=a[t])),t(r)))))),T(""),j("?.",17,(e=>e&&["?.",e])),P("?.",(e=>(e=L(e),t=>e(t)||(()=>{})))),j("?.",17,((e,t)=>e&&!(t=E(17))?.map&&["?.",e,t])),P("?.",((e,t)=>t&&(e=L(e),r=>e(r)?.[t]))),P("(",((e,t,r,a,l,s)=>"?."===e[0]&&(e[2]||Array.isArray(e[1]))&&(a=t?","===t[0]?(t=t.slice(1).map(L),e=>t.map((t=>t(e)))):(t=L(t),e=>[t(e)]):()=>[],!e[2]&&(e=e[1]),l="["===e[0]?L(e[2]):()=>e[2],r=L(e[1]),e=>r(e)?.[l(e)]?.(...a(e))))),T("in",9),P("in",((e,t)=>t&&(e=U(e),t=U(t),r=>e(r)in t(r)))),T("===",8),T("!==",9),P("===",((e,t)=>(e=U(e),t=U(t),r=>e(r)===t(r)))),P("===",((e,t)=>(e=U(e),t=U(t),r=>e(r)!==t(r)))),T("??",3),P("??",((e,t)=>t&&(e=U(e),t=U(t),r=>e(r)??t(r)))),T("??=",2,!0),P("??=",((e,t)=>(t=U(t),R(e,((e,r,a)=>e[r]??=t(a)))))),T("||=",2,!0),P("||=",((e,t)=>(t=U(t),R(e,((e,r,a)=>e[r]||=t(a)))))),T("&&=",2,!0),P("&&=",((e,t)=>(t=U(t),R(e,((e,r,a)=>e[r]&&=t(a)))))),j("undefined",20,(e=>e?x():[,void 0])),j("NaN",20,(e=>e?x():[,NaN])),j("null",20,(e=>e?x():[,null])),i.compile=e=>U(J(e));var Z=i;export{l as batch,a as computed,Z as default,r as effect,t as signal};