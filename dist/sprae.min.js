var e=Object.defineProperty,t=(e,r,a,l=null)=>{let n,s,o,i=0,c=a.length,u=r.length,{remove:p,same:f,insert:d,replace:m}=t;for(;i<c&&i<u&&f(r[i],a[i]);)i++;for(;i<c&&i<u&&f(a[c-1],r[u-1]);)l=a[(--u,--c)];if(i==u)for(;i<c;)d(l,a[i++],e);else{for(n=r[i];i<c;)o=a[i++],s=n?n.nextSibling:l,f(n,o)?n=s:i<c&&f(a[i],s)?(m(n,o,e),n=s):d(n,o,e);for(;!f(n,l);)s=n.nextSibling,p(n,e),n=s}return a};t.same=(e,t)=>e==t,t.replace=(e,t,r)=>r.replaceChild(t,e),t.insert=(e,t,r)=>r.insertBefore(t,e),t.remove=(e,t)=>t.removeChild(e);var r,a=t,l={};((t,r)=>{for(var a in r)e(t,a,{get:r[a],enumerable:!0})})(l,{batch:()=>u,computed:()=>c,current:()=>r,effect:()=>i,signal:()=>o,untracked:()=>p});var n,s,o=(e,t,a=new Set)=>((t={get value(){return r?.deps.push(a.add(r)),e},set value(t){if(t!==e){e=t;for(let e of a)e(t)}},peek:()=>e}).toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),i=(e,t,a,l)=>(l=(a=l=>{t?.call?.(),l=r,r=a;try{t=e()}finally{r=l}}).deps=[],a(),e=>{for(t?.call?.();e=l.pop();)e.delete(a)}),c=(e,t=o(),r,a)=>((r={get value(){return a||=i((()=>t.value=e())),t.value}}).toJSON=r.then=r.toString=r.valueOf=()=>r.value,r),u=e=>e(),p=(e,t,a)=>(t=r,r=null,a=e(),r=t,a),f=e=>(n=0,s=e,e=v(),s[n]?d():e||""),d=(e="Bad syntax",t=s.slice(0,n).split("\n"),r=t.pop())=>{let a=s.slice(n-108,n).split("\n").pop(),l=s.slice(n,n+108).split("\n").shift();throw EvalError(`${e} at ${t.length}:${r.length} \`${n>=108?"…":""}${a}▶${l}\``,"font-weight: bold")},m=(e=1,t=n,r)=>{if("number"==typeof e)n+=e;else for(;r=e(s.charCodeAt(n));)n+=r;return s.slice(t,n)},v=(e=0,t,r,a,l,s)=>{for(;(r=f.space())&&(l=((s=h[r])&&s(a,e))??(!a&&f.id()));)a=l;return t&&(r==t?n++:d()),a},y=e=>e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||36==e||95==e||e>=192&&215!=e&&247!=e,h=(f.id=()=>m(y),f.space=e=>{for(;(e=s.charCodeAt(n))<=32;)n++;return e},[]),b=(e,t=32,r,a=e.charCodeAt(0),l=e.length,o=h[a],i=e.toUpperCase()!==e)=>h[a]=(a,c,u=n)=>c<t&&(l<2||s.substr(n,l)==e)&&(!i||!y(s.charCodeAt(n+l)))&&(n+=l,r(a,c))||(n=u,o?.(a,c)),g=(e,t,r=!1)=>b(e,t,((a,l)=>a&&(l=v(t-(r?.5:0)))&&[e,a,l])),k=(e,t,r)=>b(e,t,(a=>r?a&&[e,a]:!a&&(a=v(t-.5))&&[e,a])),A=(e,t)=>{b(e,t,((r,a)=>(a=v(t),(!r||r[0]!==e)&&(r=[e,r]),r.push(a),r)))},O=(e,t)=>b(e[0],t,(t=>!t&&[e,v(0,e.charCodeAt(1))])),w=(e,t)=>b(e[0],t,(t=>t&&[e[0],t,v(0,e.charCodeAt(1))])),N=f,C=e=>Array.isArray(e)?e[0]?S[e[0]](...e.slice(1)):()=>e[1]:C.id(e),S=(C.id=e=>t=>t?.[e],{}),x=(e,t,r=S[e])=>S[e]=(...e)=>t(...e)||r&&r(...e),E=(e,t,r,a,l)=>"()"===e[0]?E(e[1],t,r):"string"==typeof e?r=>t(r,e,r):"."===e[0]?(a=C(e[1]),l=e[2],e=>t(a(e),l,e)):"["===e[0]?(a=C(e[1]),l=C(e[2]),e=>t(a(e),l(e),e)):r?(e=C(e),r=>t([e(r)],0,r)):()=>d("Bad left value"),$=C,T=e=>e?d():[,(e=+m((e=>46===e||e>=48&&e<=57||(69===e||101===e?2:0))))!=e?d():e];h[46]=e=>!e&&T();for(let e=48;e<=57;e++)h[e]=T;var W={n:"\n",r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},j=e=>(t,r,a="")=>{for(t&&d("Unexpected string"),m();(r=s.charCodeAt(n))-e;)92===r?(m(),r=m(),a+=W[r]||r):a+=m();return m()||d("Bad string"),[,a]};h[34]=j(34),h[39]=j(39),w("()",17),x("(",((e,t,r)=>(r=t?","===t[0]?(t=t.slice(1).map((e=>e?C(e):err())),e=>t.map((t=>t(e)))):(t=C(t),e=>[t(e)]):()=>[],E(e,((e,t,a)=>e[t](...r(a))),!0)))),w("[]",17),x("[",((e,t)=>t?(e=C(e),t=C(t),r=>e(r)[t(r)]):err())),g(".",17),x(".",((e,t)=>(e=C(e),t=t[0]?t:t[1],r=>e(r)[t]))),O("()",17),x("()",(e=>(!e&&d("Empty ()"),C(e))));var L=(...e)=>(e=e.map(C),t=>e.map((e=>e(t))).pop());A(",",1),x(",",L),A(";",1),x(";",L),g("*",12),x("*",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)*t(r)))),g("/",12),x("/",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)/t(r)))),g("%",12),x("%",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)%t(r)))),g("*=",2,!0),x("*=",((e,t)=>(t=C(t),E(e,((e,r,a)=>e[r]*=t(a)))))),g("/=",2,!0),x("/=",((e,t)=>(t=C(t),E(e,((e,r,a)=>e[r]/=t(a)))))),g("%=",2,!0),x("%=",((e,t)=>(t=C(t),E(e,((e,r,a)=>e[r]%=t(a)))))),k("+",14),x("+",((e,t)=>!t&&(e=C(e),t=>+e(t)))),k("-",14),x("-",((e,t)=>!t&&(e=C(e),t=>-e(t)))),g("+",11),x("+",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)+t(r)))),g("-",11),x("-",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)-t(r)))),g("+=",2,!0),x("+=",((e,t)=>(t=C(t),E(e,((e,r,a)=>e[r]+=t(a)))))),g("-=",2,!0),x("-=",((e,t)=>(t=C(t),E(e,((e,r,a)=>e[r]-=t(a)))))),b("++",15,(e=>e?["++-",e]:["++",v(14)])),x("++",(e=>E(e,((e,t,r)=>++e[t])))),x("++-",(e=>E(e,((e,t,r)=>e[t]++)))),b("--",15,(e=>e?["--+",e]:["--",v(14)])),x("--",(e=>E(e,((e,t,r)=>--e[t])))),x("--+",(e=>E(e,((e,t,r)=>e[t]--)))),k("~",14),x("~",((e,t)=>!t&&(e=C(e),t=>~e(t)))),g("|",5),x("|",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)|t(r)))),g("&",7),x("&",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)&t(r)))),g("^",6),x("^",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)^t(r)))),g(">>",10),x(">>",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)>>t(r)))),g("<<",10),x("<<",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)<<t(r)))),g("==",8),x("==",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)==t(r)))),g("!=",8),x("!=",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)!=t(r)))),g(">",9),x(">",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)>t(r)))),g("<",9),x("<",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)<t(r)))),g(">=",9),x(">=",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)>=t(r)))),g("<=",9),x("<=",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)<=t(r)))),k("!",14),x("!",((e,t)=>!t&&(e=C(e),t=>!e(t)))),g("||",3),x("||",((e,t)=>(e=C(e),t=C(t),r=>e(r)||t(r)))),g("&&",4),x("&&",((e,t)=>(e=C(e),t=C(t),r=>e(r)&&t(r)))),g("=",2,!0),x("=",((e,t)=>(t=C(t),E(e,((e,r,a)=>e[r]=t(a)))))),b("/*",20,((e,t)=>(m((e=>42!==e&&47!==s.charCodeAt(n+1))),m(2),e||v(t)||[]))),b("//",20,((e,t)=>(m((e=>e>=32)),e||v(t)||[""]))),g("**",13,!0),x("**",((e,t)=>t&&(e=C(e),t=C(t),r=>e(r)**t(r)))),b("?",2,((e,t,r)=>e&&(t=v(2,58))&&["?",e,t,v(3)])),x("?",((e,t,r)=>(e=C(e),t=C(t),r=C(r),a=>e(a)?t(a):r(a)))),b("true",20,(e=>e?err():[,!0])),b("false",20,(e=>e?err():[,!1])),O("[]",20),x("[]",((e,t)=>e?","===e[0]?(e=e.slice(1).map(C),t=>e.map((e=>e(t)))):(e=C(e),t=>[e(t)]):()=>[])),O("{}",20),x("{}",((e,t)=>e?","===e[0]?(e=e.slice(1).map(C),t=>Object.fromEntries(e.map((e=>e(t))))):":"===e[0]?(e=C(e),t=>Object.fromEntries([e(t)])):(t=C(e),r=>({[e]:t(r)})):()=>({}))),g(":",2,!0),x(":",((e,t)=>(t=C(t),e=Array.isArray(e)?C(e):(e=>e).bind(0,e),r=>[e(r),t(r)]))),g("=>",2,!0),x("=>",((e,t)=>(e=(e="()"===e[0]?e[1]:e)?e=","===e[0]?e.slice(1):[e]:[],t=C("{}"===t[0]?t[1]:t),(r=null)=>(r=Object.create(r),(...a)=>(e.map(((e,t)=>r[e]=a[t])),t(r)))))),g(""),b("?.",17,(e=>e&&["?.",e])),x("?.",(e=>(e=C(e),t=>e(t)||(()=>{})))),b("?.",17,((e,t)=>e&&!(t=v(17))?.map&&["?.",e,t])),x("?.",((e,t)=>t&&(e=C(e),r=>e(r)?.[t]))),x("(",((e,t,r,a,l,n)=>"?."===e[0]&&(e[2]||Array.isArray(e[1]))&&(a=t?","===t[0]?(t=t.slice(1).map(C),e=>t.map((t=>t(e)))):(t=C(t),e=>[t(e)]):()=>[],!e[2]&&(e=e[1]),l="["===e[0]?C(e[2]):()=>e[2],r=C(e[1]),e=>r(e)?.[l(e)]?.(...a(e))))),g("in",9),x("in",((e,t)=>t&&(e=$(e),t=$(t),r=>e(r)in t(r)))),g("===",8),g("!==",9),x("===",((e,t)=>(e=$(e),t=$(t),r=>e(r)===t(r)))),x("===",((e,t)=>(e=$(e),t=$(t),r=>e(r)!==t(r)))),g("??",3),x("??",((e,t)=>t&&(e=$(e),t=$(t),r=>e(r)??t(r)))),g("??=",2,!0),x("??=",((e,t)=>(t=$(t),E(e,((e,r,a)=>e[r]??=t(a)))))),g("||=",2,!0),x("||=",((e,t)=>(t=$(t),E(e,((e,r,a)=>e[r]||=t(a)))))),g("&&=",2,!0),x("&&=",((e,t)=>(t=$(t),E(e,((e,r,a)=>e[r]&&=t(a)))))),b("undefined",20,(e=>e?d():[,void 0])),b("NaN",20,(e=>e?d():[,NaN])),b("null",20,(e=>e?d():[,null]));var B=Symbol.dispose||=Symbol("dispose"),{signal:D,effect:K,batch:M,computed:P,untracked:J}=l,R={},U=new WeakMap;function Z(e,t){if(!e.children)return;if(U.has(e)){const[r,a]=U.get(e);for(let e in t)r[e]=t[e];for(let e of a)e()}const r=t||{},a=[],l=(e,t=e.parentNode)=>{if(e.attributes)for(let l=0;l<e.attributes.length;){let n=e.attributes[l];if(":"===n.name[0]){e.removeAttribute(n.name);let l=n.name.slice(1).split(":");for(let t of l){let l=(R[t]||R.default)(e,n.value,r,t);l&&(l[B]=K(l),a.push(l))}if(U.has(e))return;if(e.parentNode!==t)return!1}else l++}for(let t,r=0;t=e.children[r];r++)!1===l(t,e)&&r--};return l(e),U.has(e)||(U.set(e,[r,a]),e.classList?.add("∴"),e[B]=()=>{for(;a.length;)a.pop()[B]();e.classList.remove("∴"),U.delete(e);let t=e.getElementsByClassName("∴");for(;t.length;)t[0][B]?.()}),r}var z={},H=(e,t,r)=>{if(r=z[e=e.trim()])return r;try{r=$(N(e))}catch(r){throw Object.assign(r,{message:`∴ ${r.message}\n\n${t}${e?`="${e}"\n\n`:""}`,expr:e})}return z[e]=r},X=a,_=(e,t)=>e?.replace?e.replace(/\$<([^>]+)>/g,((e,r)=>t[r]?.valueOf?.()??"")):e;Z.use=e=>{e.signal&&(D=e.signal,K=e.effect,P=e.computed,M=e.batch||(e=>e()),J=e.untracked||M),e.swap&&(X=e.swap)};var q=Symbol(":each"),F={};R.each=(e,t,r,a)=>{let[l,n]=t.split(/\s+in\s+/),[s,o="_$"]=l.split(/\s*,\s*/);const i=e[q]=document.createTextNode("");e.replaceWith(i);const c=H(n,a),u=new WeakMap;e.removeAttribute(":key");let p=[];return()=>{let t=c(r)?.valueOf(),a=[];"number"==typeof t&&(t=Array.from({length:t},((e,t)=>t)));const l=new WeakSet;for(let n in t){let i=t[n],c=Object.create(r,{[o]:{value:n}});c[s]=i,i=i.peek?.()??i;let p,f=i.key??i.id;null==f?p=e.cloneNode(!0):(Object(f)!==f&&(f=F[f]||=Object(f)),l.has(f)?console.warn("Duplicate key",f):l.add(f),p=u.get(f)||u.set(f,e.cloneNode(!0)).get(f)),p.content&&(p=p.content.cloneNode(!0)),Z(p,c),11===p.nodeType?a.push(...p.childNodes):a.push(p)}X(i.parentNode,p,p=a,i)}};var G=Symbol("if");R.if=(e,t,r,a)=>{let l,n,s,o=e.parentNode,i=e.nextElementSibling,c=document.createTextNode(""),u=H(t,a),p=[];return e.after(c),e.content?(l=p,e.remove(),n=[...e.content.childNodes]):n=l=[e],i?.hasAttribute(":else")?(i.removeAttribute(":else"),i.hasAttribute(":if")?s=p:(i.remove(),s=i.content?[...i.content.childNodes]:[i])):s=p,()=>{const t=u(r)?.valueOf()?n:e[G]?p:s;if(i&&(i[G]=t===n),l!=t){l[0]?.[q]&&(l=[l[0][q]]),X(o,l,l=t,c);for(let e of l)Z(e,r)}}},R.ref=(e,t,r)=>{let a;return()=>{a&&delete r[a],r[a=_(t,r)]=e}},R.scope=(e,t,r,a)=>{let l=H(t,a);return()=>{Z(e,{...r,...l(r)?.valueOf?.()||{}})}},R.html=(e,t,r,a)=>{let l=H(t,a)(r);if(!l)return;let n=(l.content||l).cloneNode(!0);e.replaceChildren(n),Z(e,r)},R.text=(e,t,r)=>{let a=H(t,"text");return e.content&&e.replaceWith(e=document.createTextNode("")),()=>{let t=a(r)?.valueOf();e.textContent=null==t?"":t}},R.class=(e,t,r)=>{let a=H(t,"class"),l=new Set;return()=>{let t=a(r),n=new Set;t&&("string"==typeof t?_(t?.valueOf?.(),r).split(" ").map((e=>n.add(e))):Array.isArray(t)?t.map((e=>(e=_(e?.valueOf?.(),r))&&n.add(e))):Object.entries(t).map((([e,t])=>t?.valueOf?.()&&n.add(e))));for(let t of l)n.has(t)?n.delete(t):e.classList.remove(t);for(let t of l=n)e.classList.add(t)}},R.style=(e,t,r)=>{let a=H(t,"style"),l=e.getAttribute("style")||"";return l.endsWith(";")||(l+="; "),()=>{let t=a(r)?.valueOf();if("string"==typeof t)e.setAttribute("style",l+_(t,r));else{e.setAttribute("style",l);for(let a in t)e.style.setProperty(a,_(t[a],r))}}},R.default=(e,t,r,a)=>{let l=a.startsWith("on")&&a.slice(2),n=H(t,a);if(n){if(l){let t;return()=>(t?.(),t=I(e,l,n(r)))}return()=>{let t=n(r)?.valueOf();if(a)Y(e,a,_(t,r));else for(let a in t)Y(e,re(a),_(t[a],r))}}};var I=(e,t,r=(()=>{}))=>{const a={evt:"",target:e,test:()=>!0};a.evt=t.replace(/\.(\w+)?-?([-\w]+)?/g,((e,t,r="")=>(a.test=Q[t]?.(a,...r.split("-"))||a.test,"")));const{evt:l,target:n,test:s,defer:o,stop:i,prevent:c,...u}=a;o&&(r=o(r));const p=e=>s(e)&&(i&&e.stopPropagation(),c&&e.preventDefault(),r.call(n,e));return n.addEventListener(l,p,u),()=>n.removeEventListener(l,p,u)},Q={prevent(e){e.prevent=!0},stop(e){e.stop=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},throttle(e,t){e.defer=e=>ee(e,t?Number(t)||0:108)},debounce(e,t){e.defer=e=>te(e,t?Number(t)||0:108)},outside:e=>t=>{let r=e.target;return!(r.contains(t.target)||!1===t.target.isConnected||r.offsetWidth<1&&r.offsetHeight<1)},self:e=>t=>t.target===e.target,ctrl:(e,...t)=>e=>V.ctrl(e)&&t.every((t=>V[t]?V[t](e):e.key===t)),shift:(e,...t)=>e=>V.shift(e)&&t.every((t=>V[t]?V[t](e):e.key===t)),alt:(e,...t)=>e=>V.alt(e)&&t.every((t=>V[t]?V[t](e):e.key===t)),meta:(e,...t)=>e=>V.meta(e)&&t.every((t=>V[t]?V[t](e):e.key===t)),arrow:()=>V.arrow,enter:()=>V.enter,escape:()=>V.escape,tab:()=>V.tab,space:()=>V.space,backspace:()=>V.backspace,delete:()=>V.delete,digit:()=>V.digit,letter:()=>V.letter,character:()=>V.character},V={ctrl:e=>e.ctrlKey||"Control"===e.key||"Ctrl"===e.key,shift:e=>e.shiftKey||"Shift"===e.key,alt:e=>e.altKey||"Alt"===e.key,meta:e=>e.metaKey||"Meta"===e.key||"Command"===e.key,arrow:e=>e.key.startsWith("Arrow"),enter:e=>"Enter"===e.key,escape:e=>e.key.startsWith("Esc"),tab:e=>"Tab"===e.key,space:e=>" "===e.key||"Space"===e.key||" "===e.key,backspace:e=>"Backspace"===e.key,delete:e=>"Delete"===e.key,digit:e=>/^\d$/.test(e.key),letter:e=>/^[a-zA-Z]$/.test(e.key),character:e=>/^\S$/.test(e.key)},Y=(e,t,r)=>{null==r||!1===r?e.removeAttribute(t):e.setAttribute(t,!0===r?"":"number"==typeof r||"string"==typeof r?r:"")},ee=(e,t)=>{let r,a,l=n=>{r=!0,setTimeout((()=>{if(r=!1,a)return a=!1,l(n),e(n)}),t)};return t=>r?a=!0:(l(t),e(t))},te=(e,t)=>{let r;return a=>{clearTimeout(r),r=setTimeout((()=>{r=null,e(a)}),t)}},re=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(e=>"-"+e.toLowerCase()));R.value=(e,t,r)=>{let a,l,n=H(t,"value"),s="text"===e.type||""===e.type?t=>e.setAttribute("value",e.value=null==t?"":t):"TEXTAREA"===e.tagName||"text"===e.type||""===e.type?t=>(a=e.selectionStart,l=e.selectionEnd,e.setAttribute("value",e.value=null==t?"":t),a&&e.setSelectionRange(a,l)):"checkbox"===e.type?t=>(e.checked=t,Y(e,"checked",t)):"select-one"===e.type?t=>{for(let t in e.options)t.removeAttribute("selected");e.value=t,e.selectedOptions[0]?.setAttribute("selected","")}:t=>e.value=t;return()=>s(n(r)?.valueOf?.())},R.fx=(e,t,r,a)=>{let l=H(t,a);return()=>l(r)};export{M as batch,H as compile,P as computed,Z as default,R as directive,K as effect,_ as ipol,D as signal,X as swap,J as untracked};