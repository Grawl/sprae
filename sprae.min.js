function t(){throw new Error("Cycle detected")}function e(){if(n>1)n--;else{for(var t,e=!1;void 0!==r;){var i=r;for(r=void 0,o++;void 0!==i;){var s=i.o;if(i.o=void 0,i.f&=-3,!(8&i.f)&&a(i))try{i.c()}catch(i){e||(t=i,e=!0)}i=s}}if(o=0,n--,e)throw t}}var i=void 0,r=void 0,n=0,o=0,s=0;function f(t){if(void 0!==i){var e=t.n;if(void 0===e||e.t!==i)return i.s=e={i:0,S:t,p:void 0,n:i.s,t:i,e:void 0,x:void 0,r:e},t.n=e,32&i.f&&t.S(e),e;if(-1===e.i)return e.i=0,void 0!==e.p&&(e.p.n=e.n,void 0!==e.n&&(e.n.p=e.p),e.p=void 0,e.n=i.s,i.s.p=e,i.s=e),e}}function u(t){this.v=t,this.i=0,this.n=void 0,this.t=void 0}function h(t){return new u(t)}function a(t){for(var e=t.s;void 0!==e;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function c(t){for(var e=t.s;void 0!==e;e=e.n){var i=e.S.n;void 0!==i&&(e.r=i),e.S.n=e,e.i=-1}}function v(t){for(var e=t.s,i=void 0;void 0!==e;){var r=e.n;-1===e.i?(e.S.U(e),e.n=void 0):(void 0!==i&&(i.p=e),e.p=void 0,e.n=i,i=e),e.S.n=e.r,void 0!==e.r&&(e.r=void 0),e=r}t.s=i}function l(t){u.call(this,void 0),this.x=t,this.s=void 0,this.g=s-1,this.f=4}function p(t){return new l(t)}function d(t){var r=t.u;if(t.u=void 0,"function"==typeof r){n++;var o=i;i=void 0;try{r()}catch(e){throw t.f&=-2,t.f|=8,y(t),e}finally{i=o,e()}}}function y(t){for(var e=t.s;void 0!==e;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,d(t)}function b(t){if(i!==this)throw new Error("Out-of-order effect");v(this),i=t,this.f&=-2,8&this.f&&y(this),e()}function m(t){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function x(t){var e=new m(t);return e.c(),e.d.bind(e)}u.prototype.h=function(){return!0},u.prototype.S=function(t){this.t!==t&&void 0===t.e&&(t.x=this.t,void 0!==this.t&&(this.t.e=t),this.t=t)},u.prototype.U=function(t){var e=t.e,i=t.x;void 0!==e&&(e.x=i,t.e=void 0),void 0!==i&&(i.e=e,t.x=void 0),t===this.t&&(this.t=i)},u.prototype.subscribe=function(t){var e=this;return x((function(){var i=e.value,r=32&this.f;this.f&=-33;try{t(i)}finally{this.f|=r}}))},u.prototype.valueOf=function(){return this.value},u.prototype.toString=function(){return this.value+""},u.prototype.peek=function(){return this.v},Object.defineProperty(u.prototype,"value",{get:function(){var t=f(this);return void 0!==t&&(t.i=this.i),this.v},set:function(i){if(i!==this.v){o>100&&t(),this.v=i,this.i++,s++,n++;try{for(var r=this.t;void 0!==r;r=r.x)r.t.N()}finally{e()}}}}),(l.prototype=new u).h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===s)return!0;if(this.g=s,this.f|=1,this.i>0&&!a(this))return this.f&=-2,!0;var t=i;try{c(this),i=this;var e=this.x();(16&this.f||this.v!==e||0===this.i)&&(this.v=e,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return i=t,v(this),this.f&=-2,!0},l.prototype.S=function(t){if(void 0===this.t){this.f|=36;for(var e=this.s;void 0!==e;e=e.n)e.S.S(e)}u.prototype.S.call(this,t)},l.prototype.U=function(t){if(u.prototype.U.call(this,t),void 0===this.t){this.f&=-33;for(var e=this.s;void 0!==e;e=e.n)e.S.U(e)}},l.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;void 0!==t;t=t.x)t.t.N()}},l.prototype.peek=function(){if(this.h()||t(),16&this.f)throw this.v;return this.v},Object.defineProperty(l.prototype,"value",{get:function(){1&this.f&&t();var e=f(this);if(this.h(),void 0!==e&&(e.i=this.i),16&this.f)throw this.v;return this.v}}),m.prototype.c=function(){var t=this.S();try{8&this.f||void 0===this.x||(this.u=this.x())}finally{t()}},m.prototype.S=function(){1&this.f&&t(),this.f|=1,this.f&=-9,d(this),c(this),n++;var e=i;return i=this,b.bind(this,e)},m.prototype.N=function(){2&this.f||(this.f|=2,this.o=r,r=this)},m.prototype.d=function(){this.f|=8,1&this.f||y(this)};var w=t=>t&&t.peek,S=Symbol("signal-struct");function g(t){if(t[S])return t;const i=t=>t&&"string"!=typeof t&&"number"!=typeof t?w(t)?t:Array.isArray(t)?Object.freeze(t.map(i)):j(t)?Object.freeze(Object.fromEntries(Object.entries(t).map((([t,e])=>[t,i(e)])))):h(t):h(t),r=i(t),o=(t,i)=>{let r;if(Array.isArray(t)){r=[];for(let e=0;e<t.length;e++)s(t[e],e,r)}else if(j(t)){r={};for(let e in t)s(t[e],e,r)}else r=t;return i&&(Object.defineProperty(r,Symbol.iterator,{value:function*(){yield t,yield t=>function(t){if(n>0)return t();n++;try{return t()}finally{e()}}((()=>A(r,t)))},enumerable:!1,configurable:!1}),r[S]=!0),Object.seal(r)},s=(t,e,i)=>{w(t)?Object.defineProperty(i,e,{get:()=>t.value,set(e){t.value=e},enumerable:!0,configurable:!1}):i[e]=o(t)};return o(r,!0)}function A(t,e){for(let i in e){let r=e[i],n=t[i];j(r)&&j(n)?t[i]=A(n,r):t[i]=e[i]}return t}function j(t){return"object"==typeof t&&null!==t}var O=new WeakMap;function E(t,e){if(O.has(t))return O.get(t);e||={};const i=g(e);for(let e in $){const r=`[${e.replaceAll(":","\\:")}]`,n=$[e];t.matches?.(r)&&n(t,i),t.querySelectorAll?.(r).forEach((e=>t.contains(e)&&n(e,i)))}return O.set(t,i),i}var $={},k=(t,e)=>{const i=t.replaceAll(":","∴");return $[t]=(r,n)=>{if(r.classList.contains(i))return;r.classList.add(i);let o=r.getAttribute(t);r.removeAttribute(t),e(r,o,n)}},L=(t,e,i)=>{e.startsWith("on")&&(e=e.toLowerCase()),t[e]!==i&&(t[e]=i),!1===i||null==i?t.removeAttribute(e):"function"!=typeof i&&t.setAttribute(C(e),!0===i?"":"number"==typeof i||"string"==typeof i?i:"class"===e?(Array.isArray(i)?i:Object.entries(i).map((([t,e])=>e?t:""))).filter(Boolean).join(" "):"style"===e?Object.entries(i).map((([t,e])=>`${t}: ${e}`)).join(";"):"")},U=document.createElement("div"),C=t=>{U.dataset[t]="";let e=U.attributes[0].name.slice(5);return delete U.dataset[t],e};function N(t){k(":"+t,((e,i,r)=>{let n=z(i,t);x((()=>{return i=n(r),L(e,t,i);var i}))}))}k(":with",((t,e,i)=>{let r=z(e,"with");const[n]=i;E(t,Object.assign({},n,r(n)))})),k(":if",((t,e,i)=>{let r=new Text,n=[z(e,"if")],o=[t],s=t;for(;(s=t.nextElementSibling)&&s.hasAttribute(":else");)s.removeAttribute(":else"),(e=s.getAttribute(":if"))?(s.removeAttribute(":if"),s.remove(),o.push(s),n.push(z(e,"else-if"))):(s.remove(),o.push(s),n.push((()=>1)));t.replaceWith(s=r),p((()=>n.findIndex((t=>t(i))))).subscribe((t=>o[t]!=s&&(s.replaceWith(s=o[t]||r),E(s,i))))})),N("id"),N("name"),N("for"),N("type"),N("hidden"),N("disabled"),N("href"),N("src"),N("style"),N("class"),k(":aria",((t,e,i)=>{let r=z(e,"aria");p((()=>r(i))).subscribe((e=>{for(let i in e)L(t,"aria"+i[0].toUpperCase()+i.slice(1),e[i])}))})),k(":data",((t,e,i)=>{let r=z(e,"aria");p((()=>r(i))).subscribe((e=>{for(let i in e)t.dataset[i]=e[i]}))})),k(":on",((t,e,i)=>{let r,n=z(e,"aria");p((()=>n(i))).subscribe((e=>{for(let e in r)t.removeEventListener(e,r[e]);r=e;for(let e in r)t.addEventListener(e,r[e])}))})),k(":prop",((t,e,i)=>{let r=z(e,"prop");p((()=>r(i))).subscribe((e=>{if(e)for(let i in e)L(t,i,e[i])}))})),k(":text",((t,e,i)=>{let r=z(e,"text");p((()=>r(i))).subscribe((e=>{t.textContent=null==e?"":e}))})),k(":value",((t,e,i)=>{let r=z(e,"value"),[n,o]=(t=>["checkbox"===t.type?()=>t.checked:()=>t.value,"text"===t.type||""===t.type?e=>t.value=null==e?"":e:"checkbox"===t.type?e=>(t.value=e?"on":"",L(t,"checked",e)):"select-one"===t.type?e=>([...t.options].map((t=>t.removeAttribute("selected"))),t.value=e,t.selectedOptions[0]?.setAttribute("selected","")):e=>t.value=e])(t),s=function(t){return P[t]?P[t]:P[t]=new Function(["scope","value"],`with (scope) { ${t} = value };`)}(e),f=e=>s(i,n(t));t.addEventListener("input",f),t.addEventListener("change",f),p((()=>r(i))).subscribe((e=>{L(t,"value",e),o(e)}))}));var P={},W={};function z(t,e){if(W[t])return W[t];let i,r=/^[\n\s]*if.*\(.*\)/.test(t)||/^(let|const)\s/.test(t)?`(() => { ${t} })()`:t;try{i=new Function(["scope"],`let result; with (scope) { result = ${r} }; return result;`)}catch(i){return F(i,t,e)}return W[t]=r=>{let n;try{n=i(r)}catch(i){return F(i,t,e)}return n}}function F(t,e,i){Object.assign(t,{expression:e}),console.warn(`∴ ${t.message}\n\n${i}=${e?`"${e}"\n\n`:""}`),setTimeout((()=>{throw t}),0)}var T=E;export{T as default,k as directive,$ as directives};